---
export const prerender = false;

import { getCollection } from "astro:content";
import Reservoir from "reservoir";

import Quote, { type QuoteData } from "../../components/Quote.astro";
import Layout from "../../layouts/Layout.astro";

interface Props {
    path: string | undefined;
}

const { path } = Astro.params;

let quotes = await getCollection("quotes");
let selectedQuotes = Reservoir<QuoteData>(25);

if (path === undefined) {
    quotes.forEach((quote) => selectedQuotes.pushSome(quote.data));
} else if (path === "positive") {
    quotes.forEach((quote) => {
        if (quote.data.score > 0) {
            selectedQuotes.pushSome(quote.data);
        }
    });
} else {
    return Astro.redirect("/404");
}
---

<Layout title="Random Quotes">
    {
        selectedQuotes.map((data) => {
            return <Quote data={data} />;
        })
    }
</Layout>
